<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Technical Analysis</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='technicalAnalysis.css') }}">
</head>
<body>
<h1>Technical Analysis for Stock</h1>

{% if indicators %}
<div class="results-container">
    <h2>Analysis Results for {{ issuer }}</h2>
    <table class="results-table">
        <tr>
            <th>Indicator</th>
            <th>Value</th>
        </tr>
        <tr>
            <td>SMA 20</td>
            <td>{{ indicators.get('SMA_20', 'Insufficient Data') }}</td>
        </tr>
        <tr>
            <td>SMA 50</td>
            <td>{{ indicators.get('SMA_50', 'Insufficient Data') }}</td>
        </tr>
        <tr>
            <td>EMA 20</td>
            <td>{{ indicators.get('EMA_20', 'Insufficient Data') }}</td>
        </tr>
        <tr>
            <td>EMA 50</td>
            <td>{{ indicators.get('EMA_50', 'Insufficient Data') }}</td>
        </tr>
        <tr>
            <td>RSI</td>
            <td>{{ indicators.get('RSI', 'Insufficient Data') }}</td>
        </tr>
        <tr>
            <td>MACD</td>
            <td>{{ indicators.get('MACD', 'Insufficient Data') }}</td>
        </tr>
        <tr>
            <td>Bollinger Upper</td>
            <td>{{ indicators.get('Bollinger_Upper', 'Insufficient Data') }}</td>
        </tr>
        <tr>
            <td>Bollinger Lower</td>
            <td>{{ indicators.get('Bollinger_Lower', 'Insufficient Data') }}</td>
        </tr>
    </table>
</div>
{% endif %}

<!-- Explanation section -->
<div>
    <h3>Algorithm Explanations</h3>
    <p><strong>SMA (Simple Moving Average):</strong> The SMA is the average of a set of values over a defined number of
        periods. It helps identify trends over a short period.</p>
    <p><strong>EMA (Exponential Moving Average):</strong> The EMA gives more weight to recent prices, making it more
        responsive to recent price changes than the SMA.</p>
    <p><strong>RSI (Relative Strength Index):</strong> The RSI is a momentum oscillator that measures the speed and
        change of price movements. It ranges from 0 to 100 and helps identify overbought or oversold conditions.</p>
    <p><strong>MACD (Moving Average Convergence Divergence):</strong> The MACD is a trend-following momentum indicator
        that shows the relationship between two moving averages of a securityâ€™s price.</p>
    <p><strong>Bollinger Bands:</strong> Bollinger Bands consist of a middle band (SMA), upper band (SMA + 2*standard
        deviation), and lower band (SMA - 2*standard deviation). They help identify volatility and overbought/oversold
        conditions.</p>
</div>

<form method="POST">
    <div style="display: flex; gap: 10px; margin-top: 10px;">
        <label for="issuer">Choose an Issuer:</label>
        <select name="issuer" id="issuer">
            {% for issuer_name in issuers %}
            <option value="{{ issuer_name }}" {% if issuer_name== issuer %} selected {% endif %}>{{ issuer_name }}
            </option>
            {% endfor %}
        </select>
        <button type="submit" class="btn btn-primary">Analyze</button>

        <button>
            <a href="{{ url_for('index') }}">Back</a>
        </button>
    </div>
</form>

<br>

{% if insufficient_data %}
<div id="popup" class="popup">
    <div class="popup-content" data-missing="{{ missing_count }}">
        <h3>Insufficient Data</h3>
        <ul>
            {% for algorithm, message in insufficient_data.items() %}
            <li>{{ message }}</li>
            {% endfor %}
        </ul>
        <button onclick="closePopup()">Close</button>
    </div>
</div>

<script>
    // Display the popup if there is insufficient data
    document.getElementById('popup').style.display = 'flex';

    function closePopup() {
        document.getElementById('popup').style.display = 'none'; // Hide the popup
    }
</script>
{% endif %}

</body>
</html>